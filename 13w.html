<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
    <title>十三水•Chinese Poker</title>
    <style>
h1 {
  color: brown;
  font-size: 40px;
}
h2 {
  color: brown;
  font-size: 30px;
}
td.menu {
  font-size: 20px;
}
button.menu {
  font-size: 20px;
}
button.move {
  font-size: 30px;
}
td.move {
  text-align: center;
}
td.pattern {
  color: darkblue;
  font-size: 20px;
  text-align: center;
}
table.hand {
  background-color: green;
  border-radius: 5px;
  padding: 2px;
}
table.card {
  background-color: white;
  border-radius: 5px;
  padding: 0px;
  text-align: center;
  width: 60px;
}
td.rank {
  font-size: 30px;
}
td.suit {
  font-size: 25px;
}
    </style>
    <script>
var suit_symbols = [
  '<font color="black">♠</font>',
  '<font color="red">♥</font>',
  '<font color="black">♣</font>',
  '<font color="red">♦</font>',
];
var rank_symbols = [
  '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A' ];
var Two = 0, Three = 1, Four = 2, Five = 3, Six = 4, Seven = 5, Eight = 6,
    Nine = 7, Ten = 8, Jack = 9, Queen = 10, King = 11, Ace = 12;

var pattern_symbols = [
    'junk', 'pair', 'two pairs', 'triple', 'straight',
    'flush', 'full house', 'quadruple', 'straight flush'
];
var Junk = 0, Pair = 1, TwoPairs = 2, Triple = 3, Straight = 4,
    Flush = 5, FullHouse = 6, Quadruple = 7, StraightFlush = 8;

var hand = [];
var sorted_by = '';
var wave_sizes = { front: 3, center: 5, back: 5 };
var wave_values = { front: 0, center: 0, back: 0 };
var waves = { front: [], center: [], back: [] };
var membership = {};
var active_wave = 'front';
var saved_waves = [];

function suit(card) { return Math.floor(card / 13); }
function rank(card) { return card % 13; }

function deal_new_hand() {
  var deck = [];
  for (var i = 0; i < 52; ++i) {
    deck.push(i);
  }
  for (var i = 0; i < 13; ++i) {
    var pos = Math.floor(Math.random() * (52 - i));
    var card = deck[pos];
    deck[pos] = deck[52 - i - 1];
    hand[i] = card;
  }

  membership = {};
  sort_hand();
  for (var name in waves) {
    waves[name] = [];
    redraw_wave(name);
  }
  undo_all_cards();
  saved_waves = [];
  set_inner_html('load', '');
}

function sort_hand() {
  if (sorted_by == 'suit') {
    hand.sort(function(a, b) { return rank(a) - rank(b); });
    sorted_by = 'rank';
    set_inner_html('sort', 'Sort by suit');
  } else {
    hand.sort(function(a, b) {
      return suit(a) == suit(b) ? rank(a) - rank(b) : suit(a) - suit(b);
    });
    sorted_by = 'suit';
    set_inner_html('sort', 'Sort by rank');
  }
  redraw_hand();
}

function redraw_hand() {
  for (var i = 0; i < 13; ++i) {
    set_card('', i, hand[i]);
    if (membership[hand[i]] == null) {
      enable_card('', i);
    } else {
      disable_card('', i);
    }
  }
}

function activate_wave(name) {
  document.getElementById(active_wave).style.backgroundColor = 'green';
  document.getElementById(name).style.backgroundColor = 'orange';
  active_wave = name;
}

function move_card(index) {
  var card = hand[index];
  if (membership[card] != null) {
    var name = membership[card];
    for (var i = 0; i < waves[name].length; ++i) {
      if (waves[name][i] == card) {
        undo_card(membership[card], i);
        break;
      }
    }
    return;
  }

  disable_card('', index);
  membership[card] = active_wave;
  waves[active_wave].push(card);
  sort_wave(active_wave);

  if (waves[active_wave].length == wave_sizes[active_wave]) {
    for (var name in waves) {
      if (waves[name].length < wave_sizes[name]) {
        activate_wave(name);
        break;
      }
    }
  }
}

// Special case for 2345A.
function sort_special_straight(cards) {
  if (rank(cards[0]) == Two &&
      rank(cards[1]) == Three && rank(cards[2]) == Four &&
      rank(cards[3]) == Five && rank(cards[4]) == Ace) {
    var temp = cards[4];
    cards[4] = cards[3];
    cards[3] = cards[2];
    cards[2] = cards[1];
    cards[1] = cards[0];
    cards[0] = temp;
  }
}

function sort_wave(name) {
  var cards = waves[name];
  cards.sort(function(a, b) { return rank(a) - rank(b); });
  if (cards.length == 5) {
    sort_special_straight(cards);
  }
  redraw_wave(name);
}

function fill_wave(name) {
  activate_wave(name);
  for (var i = waves[name].length; i < wave_sizes[name]; ++i) {
    for (var j = 0; j < 13; ++j) {
      if (membership[hand[j]] == null) {
        move_card(j);
        break;
      }
    }
  }
}

function move_all_cards() {
  for (var i = 0; i < 13; ++i) {
    move_card(i);
  }
}

function undo_all_cards() {
  for (var name in waves) {
    clear_wave(name);
  }
}

function clear_wave(name) {
  for (var i = waves[name].length - 1; i >= 0; --i) {
    undo_card(name, i);
  }
  redraw_wave(name);
}

function undo_card(name, index) {
  if (waves[name].length <= index) {
    redraw_wave(name);
    return;
  }

  var card = waves[name][index];
  for (var i = 0; i < 13; ++i) {
    if (hand[i] == card) {
      enable_card('', i);
      delete membership[card];
      break;
    }
  }
  waves[name].splice(index, 1);
  redraw_wave(name);
}

function redraw_wave(name) {
  for (var i = 0; i < waves[name].length; ++i) {
    set_card(name + '_', i, waves[name][i]);
  }
  for (var i = waves[name].length; i < wave_sizes[name]; ++i) {
    clear_card(name + '_', i);
  }
  activate_wave(name);

  if (waves[name].length < wave_sizes[name]) {
    set_inner_html(name + '_pattern', '&nbsp;');
    wave_values[name] = 0;
  } else {
    var eval = evaluate_wave(name);
    set_inner_html(name + '_pattern',
                   pattern_symbols[eval.pattern] + ': ' + eval.value + '%');
    wave_values[name] = eval.value;
  }
  var sum = 0;
  for (var name in wave_values) {
    sum += wave_values[name];
  }
  set_inner_html('average', 'average: ' + Math.floor(sum / 3) + '%');
}

function set_card(waves, index, card) {
  set_inner_html(waves + 'suit_' + index, suit_symbols[suit(card)]);
  set_inner_html(waves + 'rank_' + index, rank_symbols[rank(card)]);
}

function clear_card(waves, index) {
  set_inner_html(waves + 'suit_' + index, '?');
  set_inner_html(waves + 'rank_' + index, '?');
}

function enable_card(waves, index) {
  var id = waves + 'card_' + index;
  document.getElementById(id).style.backgroundColor = 'white';
}

function disable_card(waves, index) {
  var id = waves + 'card_' + index;
  document.getElementById(id).style.backgroundColor = 'lightgrey';
}

function set_inner_html(id, value) {
  document.getElementById(id).innerHTML = value;
}

function save_waves() {
  for (var name in waves) {
    if (waves[name].length < wave_sizes[name]) {
      alert('Please finish all three waves before saving them.');
      return;
    }
  }
  for (var number in saved_waves) {
    var duplicate = true;
    for (var card in membership) {
      if (membership[card] != saved_waves[number][card]) {
        duplicate = false;
        break;
      }
    }
    if (duplicate) {
      alert('Waves already saved as #' + (Number(number) + 1));
      return;
    }
  }
  var number = saved_waves.length;
  saved_waves.push({});
  for (var card in membership) {
    saved_waves[number][card] = membership[card];
  }

  var button = document.createElement('BUTTON');
  button.innerHTML = '#' + Math.floor(number + 1);
  button.className = 'menu';
  button.onclick = function() { load_waves(number) };
  document.getElementById('load').appendChild(button);
}

function load_waves(number) {
  for (var card in saved_waves[number]) {
    membership[card] = saved_waves[number][card];
  }

  for (var name in waves) {
    waves[name] = [];
  }
  for (var card in membership) {
    waves[membership[card]].push(card);
  }
  for (var name in waves) {
    sort_wave(name);
  }
  redraw_hand();
}

var junk_value = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [ 0,  0,  0,  0,  0,  1,  1,  2,  2,  4,  7, 15, 34],
  [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
  [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0]
];

var junk_value0 = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [ 0, 20, 20, 21, 21, 22, 23, 24, 26, 30, 34, 42,  0],  //A?
  [ 0,  9,  9, 10, 10, 11, 11, 12, 13, 15, 18,  0,  0],  //K?
  [ 0,  5,  5,  5,  6,  6,  7,  7,  8,  8,  0,  0,  0]   //Q?
];

var one_pair_value = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [45, 47, 49, 51, 53, 56, 60, 64, 68, 73, 81, 89, 97],
  [ 2,  3,  3,  4,  5,  6,  8, 10, 12, 15, 18, 24, 33],
  [ 0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  2,  2,  3]
];

var one_pair_value0 = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [96, 96, 96, 96, 96, 96, 97, 97, 97, 97, 98, 98,  0],  //A?
  [86, 86, 86, 86, 86, 87, 87, 88, 89, 89, 90,  0, 91],  //K?
  [76, 76, 77, 77, 77, 78, 78, 78, 79, 80,  0, 82, 83]   //Q?
];

var one_pair_value1 = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [ 0,  0, 30, 31, 31, 32, 32, 33, 33, 34, 35, 36,  0],  //A?
  [ 0,  0, 23, 23, 23, 23, 23, 24, 25, 25, 26,  0, 27],  //K?
  [ 0,  0, 17, 17, 18, 18, 18, 19, 19, 20,  0, 21, 22]   //Q?
];

var two_pair_value = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0],
  [ 0, 37, 37, 39, 41, 43, 46, 49, 54, 58, 62, 64, 64],
  [ 0,  3,  3,  4,  4,  5,  7,  8, 10, 11, 13, 14, 14]
];

var triple_value = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [99, 99, 99, 99, 99,100,100,100,100,100,100,100,100],
  [63, 66, 69, 71, 72, 72, 74, 74, 74, 75, 75, 75, 76],
  [12, 13, 13, 15, 16, 16, 16, 16, 16, 14, 15, 15, 15]
];

var straight_value = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0],
  [ 0,  0,  0, 77, 79, 81, 83, 85, 87, 88, 89, 91, 92],
  [ 0,  0,  0, 16, 18, 20, 22, 24, 26, 28, 31, 34, 37]
];

var flush_value = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0],
  [ 0,  0,  0,  0,  0, 93, 92, 92, 93, 94, 95, 97, 98],
  [ 0,  0,  0,  0,  0, 35, 37, 38, 38, 40, 44, 50, 61]
];

var flush_value2 = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [ 0,  0,  0,  0, 53, 54, 55, 56, 57, 59, 62, 65,  0],  //A?
  [ 0,  0,  0, 44, 44, 45, 46, 47, 48, 49, 52,  0,  0],  //K?
  [ 0,  0,  0, 41, 41, 41, 42, 42, 44, 45,  0,  0,  0]   //Q?
];

var full_value = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0],
  [98, 99, 99, 99, 99, 99, 99, 99,100,100,100,100,100],
  [65, 66, 69, 71, 73, 75, 78, 80, 82, 85, 88, 91, 94],
];

var quadruple_value = [
  //2   3   4   5   6   7   8   9   T   J   Q   K   A
  [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0],
  [100,100,100,100,100,100,100,100,100,100,100,100,100],
  [ 94, 94, 95, 95, 95, 96, 97, 97, 97, 97, 98, 98, 98]
];

function evaluate_wave(name) {
  var cards = waves[name];
  var junks = [];
  var pairs = [];
  var triples = [];
  var quadruples = [];
  for (var i = 0; i < cards.length; ++i) {
    var r = rank(cards[i]);
    if (i + 1 >= cards.length || r != rank(cards[i + 1])) {
      junks.push(r);
    } else if (i + 2 >= cards.length || r != rank(cards[i + 2])) {
      pairs.push(r);
      i += 1;
    } else if (i + 3 >= cards.length || r != rank(cards[i + 3])) {
      triples.push(r);
      i += 2;
    } else {
      quadruples.push(r);
      i += 3;
    }
  }
  var flush = true;
  var straight = true;
  if (cards.length == 3) {
    flush = false;
    straight = false;
  } else {
    for (var i = 0; i < cards.length - 1; ++i) {
      if (suit(cards[i]) != suit(cards[i + 1])) {
        flush = false;
      }
      if (rank(cards[i]) + 1 != rank(cards[i + 1]) &&
          !(i == 0 && rank(cards[0]) == Ace && rank(cards[1]) == Two)) {
        straight = false;
      }
    }
  }

  var wave = name == 'front' ? 0 : name == 'center' ? 1 : 2;
  var rank1 = rank(cards[cards.length - 1]);
  var rank2 = rank(cards[cards.length - 2]);

  if (straight && flush) {
    return { pattern: StraightFlush, high: rank1, value: 100 };
  } else if (quadruples.length > 0) {
    return { pattern: Quadruple, high: quadruples[0],
      value: quadruple_value[wave][quadruples[0]] };
  } else if (triples.length > 0 && pairs.length > 0) {
    return { pattern: FullHouse, high: triples[0],
      value: full_value[wave][triples[0]] };
  } else if (flush) {
    if (wave == 2 && rank1 >= 10) {
      return { pattern: Flush, high: rank1,
        value: flush_value2[12 - rank1][rank2] };
    }
    return { pattern: Flush, high: rank1, value: flush_value[wave][rank1] };
  } else if (straight) {
    return { pattern: Straight, high: rank1,
      value: straight_value[wave][rank1] };
  } else if (triples.length > 0) {
    return { pattern: Triple, high: triples[0],
      value: triple_value[wave][triples[0]] };
  } else if (pairs.length > 1) {
    return { pattern: TwoPairs, high: pairs[1],
      value: two_pair_value[wave][pairs[1]] };
  } else if (pairs.length > 0) {
    rank1 = pairs[0];
    rank2 = junks[junks.length - 1];
    if (wave == 0 && pairs[0] >= 10) {
      return { pattern: Pair, high: pairs[0],
        value: one_pair_value0[12 - rank1][rank2] };
    }
    if (wave == 1 && pairs[0] >= 10) {
      return { pattern: Pair, high: pairs[0],
        value: one_pair_value1[12 - rank1][rank2] };
    }
    return { pattern: Pair, high: pairs[0],
      value: one_pair_value[wave][pairs[0]] };
  }

  if (wave == 0 && rank1 >= 10) {
    return { pattern: Junk, high: rank1,
      value: junk_value0[12 - rank1][rank2] };
  }
  return { pattern: Junk, high: rank1, value: junk_value[wave][rank1] };
}

var max_value = 0;
var max_waves = { front: [], center: [], back: [] };

function optimize_waves() {
  undo_all_cards();

  if (sorted_by != 'rank') {
    sort_hand();
  }

  max_value = 0;
  optimize_back();

  for (var name in max_waves) {
    waves[name] = [];
    for (var index in max_waves[name]) {
      waves[name].push(max_waves[name][index]);
      membership[max_waves[name][index]] = name;
    }
    redraw_wave(name);
  }
  redraw_hand();
}

function optimize_back() {
  for (var b1 = 0; b1 < 9; ++b1) {
    for (var b2 = b1 + 1; b2 < 10; ++b2) {
      for (var b3 = b2 + 1; b3 < 11; ++b3) {
        for (var b4 = b3 + 1; b4 < 12; ++b4) {
          for (var b5 = b4 + 1; b5 < 13; ++b5) {
            waves['back'] = [hand[b1], hand[b2], hand[b3], hand[b4], hand[b5]];
            sort_special_straight(waves['back']);
            var back_eval = evaluate_wave('back');
            if (back_eval.pattern == Junk) continue;
            if (200 + back_eval.value < max_value) continue;

            var bits = (1<<b1) + (1<<b2) + (1<<b3) + (1<<b4) + (1<<b5);
            optimize_center(back_eval, bits);
          }
        }
      }
    }
  }
}

function optimize_center(back_eval, bits) {
  out:
  for (var c1 = 0; c1 < 9; ++c1) {
    if ((1 << c1) & bits) continue;
    for (var c2 = c1 + 1; c2 < 10; ++c2) {
      if ((1 << c2) & bits) continue;
      for (var c3 = c2 + 1; c3 < 11; ++c3) {
        if ((1 << c3) & bits) continue;
        for (var c4 = c3 + 1; c4 < 12; ++c4) {
          if ((1 << c4) & bits) continue;
          for (var c5 = c4 + 1; c5 < 13; ++c5) {
            if ((1 << c5) & bits) continue;

            waves['center'] = [hand[c1], hand[c2], hand[c3], hand[c4], hand[c5]];
            sort_special_straight(waves['center']);
            var center_eval = evaluate_wave('center');
            if (center_eval.pattern > back_eval.pattern) break out;
            if (center_eval.pattern == back_eval.pattern &&
                center_eval.high > back_eval.high) break out;
            if (100 + center_eval.value + back_eval.value < max_value) continue;

            var center_bits = (1<<c1) + (1<<c2) + (1<<c3) + (1<<c4) + (1<<c5);
            optimize_front(center_eval, back_eval, bits + center_bits);
          }
        }
      }
    }
  }
}

function optimize_front(center_eval, back_eval, bits) {
  out:
  for (var f1 = 0; f1 < 11; ++f1) {
    if ((1 << f1) & bits) continue;
    for (var f2 = f1 + 1; f2 < 12; ++f2) {
      if ((1 << f2) & bits) continue;
      for (var f3 = f2 + 1; f3 < 13; ++f3) {
        if ((1 << f3) & bits) continue;

        waves['front'] = [hand[f1], hand[f2], hand[f3]];
        var front_eval = evaluate_wave('front');
        if (front_eval.pattern > center_eval.pattern) break out;
        if (front_eval.pattern == center_eval.pattern &&
            front_eval.high > center_eval.high) break out;

        var sum_value = front_eval.value + center_eval.value + back_eval.value;
        if (max_value < sum_value) {
          max_value = sum_value;
          for (var name in waves) {
            max_waves[name] = [];
            for (var index in waves[name]) {
              max_waves[name].push(waves[name][index]);
            }
          }
        }
      }
    }
  }
}
    </script>
  </head>
  <body onload='deal_new_hand()'>
    <h1>十三水•Chinese Poker</h1>
    <hr/>
    <h2>AI</h2>
    <table>
      <tr>
        <td>
          <table class='hand' id='ai_front'>
            <tr>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_front_rank_0'>?</td></tr>
                  <tr><td class='suit' id='ai_front_suit_0'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_front_rank_1'>?</td></tr>
                  <tr><td class='suit' id='ai_front_suit_1'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_front_rank_2'>?</td></tr>
                  <tr><td class='suit' id='ai_front_suit_2'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
        <td>
          <table class='hand' id='ai_center'>
            <tr>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_center_rank_0'>?</td></tr>
                  <tr><td class='suit' id='ai_center_suit_0'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_center_rank_1'>?</td></tr>
                  <tr><td class='suit' id='ai_center_suit_1'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_center_rank_2'>?</td></tr>
                  <tr><td class='suit' id='ai_center_suit_2'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_center_rank_3'>?</td></tr>
                  <tr><td class='suit' id='ai_center_suit_3'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_center_rank_4'>?</td></tr>
                  <tr><td class='suit' id='ai_center_suit_4'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
        <td>
          <table class='hand' id='ai_back'>
            <tr>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_back_rank_0'>?</td></tr>
                  <tr><td class='suit' id='ai_back_suit_0'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_back_rank_1'>?</td></tr>
                  <tr><td class='suit' id='ai_back_suit_1'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_back_rank_2'>?</td></tr>
                  <tr><td class='suit' id='ai_back_suit_2'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_back_rank_3'>?</td></tr>
                  <tr><td class='suit' id='ai_back_suit_3'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card'>
                  <tr><td class='rank' id='ai_back_rank_4'>?</td></tr>
                  <tr><td class='suit' id='ai_back_suit_4'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
    <hr/>

    <table>
      <tr>
        <td>
          <h2>Player &nbsp; &nbsp;</h2>
        </td>
        <td>
          <button class='menu' onclick='deal_new_hand()'>Deal</button>
          &nbsp; &nbsp;
        </td>
        <td>
          <button class='menu' onclick='optimize_waves()'>Optimize</button>
          &nbsp; &nbsp;
        </td>
        <td>
          <button class='menu' onclick='save_waves()'>Save</button>
          &nbsp; &nbsp;
        </td>
        <td class='menu'>
          Load:
        </td>
        <td id='load'>
        </td>
      </tr>
    </table>

    <table>
      <tr>
        <td class='pattern' id='front_pattern'>&nbsp;</td>
        <td class='pattern' id='center_pattern'>&nbsp;</td>
        <td class='pattern' id='back_pattern'>&nbsp;</td>
        <td class='pattern' id='average'>&nbsp;</td>
      </tr>
      <tr>
        <td>
          <table class='hand' id='front'>
            <tr>
              <td>
                <table class='card' onclick='undo_card("front", 0)'>
                  <tr><td class='rank' id='front_rank_0'>?</td></tr>
                  <tr><td class='suit' id='front_suit_0'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("front", 1)'>
                  <tr><td class='rank' id='front_rank_1'>?</td></tr>
                  <tr><td class='suit' id='front_suit_1'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("front", 2)'>
                  <tr><td class='rank' id='front_rank_2'>?</td></tr>
                  <tr><td class='suit' id='front_suit_2'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
        <td>
          <table class='hand' id='center'>
            <tr>
              <td>
                <table class='card' onclick='undo_card("center", 0)'>
                  <tr><td class='rank' id='center_rank_0'>?</td></tr>
                  <tr><td class='suit' id='center_suit_0'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("center", 1)'>
                  <tr><td class='rank' id='center_rank_1'>?</td></tr>
                  <tr><td class='suit' id='center_suit_1'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("center", 2)'>
                  <tr><td class='rank' id='center_rank_2'>?</td></tr>
                  <tr><td class='suit' id='center_suit_2'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("center", 3)'>
                  <tr><td class='rank' id='center_rank_3'>?</td></tr>
                  <tr><td class='suit' id='center_suit_3'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("center", 4)'>
                  <tr><td class='rank' id='center_rank_4'>?</td></tr>
                  <tr><td class='suit' id='center_suit_4'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
        <td>
          <table class='hand' id='back'>
            <tr>
              <td>
                <table class='card' onclick='undo_card("back", 0)'>
                  <tr><td class='rank' id='back_rank_0'>?</td></tr>
                  <tr><td class='suit' id='back_suit_0'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("back", 1)'>
                  <tr><td class='rank' id='back_rank_1'>?</td></tr>
                  <tr><td class='suit' id='back_suit_1'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("back", 2)'>
                  <tr><td class='rank' id='back_rank_2'>?</td></tr>
                  <tr><td class='suit' id='back_suit_2'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("back", 3)'>
                  <tr><td class='rank' id='back_rank_3'>?</td></tr>
                  <tr><td class='suit' id='back_suit_3'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' onclick='undo_card("back", 4)'>
                  <tr><td class='rank' id='back_rank_4'>?</td></tr>
                  <tr><td class='suit' id='back_suit_4'>?</td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
        <td>
          <button class='menu' onclick='undo_all_cards()'>Clear all</button>
        </td>
      </tr>
      <tr>
        <td class='move'>
          <button class='move' onclick='fill_wave("front")'>⇈</button>
          &nbsp; &nbsp;
          <button class='move' onclick='clear_wave("front")'>⇊</button>
        </td>
        <td class='move'>
          <button class='move' onclick='fill_wave("center")'>⇈</button>
          &nbsp; &nbsp;
          <button class='move' onclick='clear_wave("center")'>⇊</button>
        </td>
        <td class='move'>
          <button class='move' onclick='fill_wave("back")'>⇈</button>
          &nbsp; &nbsp;
          <button class='move' onclick='clear_wave("back")'>⇊</button>
        </td>
      </tr>
    </table>

    <table>
      <tr>
        <td>
          <table class='hand'>
            <tr>
              <td>
                <table class='card' id='card_0' onclick='move_card(0)'>
                  <tr><td class='rank' id='rank_0'></td></tr>
                  <tr><td class='suit' id='suit_0'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_1' onclick='move_card(1)'>
                  <tr><td class='rank' id='rank_1'></td></tr>
                  <tr><td class='suit' id='suit_1'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_2' onclick='move_card(2)'>
                  <tr><td class='rank' id='rank_2'></td></tr>
                  <tr><td class='suit' id='suit_2'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_3' onclick='move_card(3)'>
                  <tr><td class='rank' id='rank_3'></td></tr>
                  <tr><td class='suit' id='suit_3'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_4' onclick='move_card(4)'>
                  <tr><td class='rank' id='rank_4'></td></tr>
                  <tr><td class='suit' id='suit_4'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_5' onclick='move_card(5)'>
                  <tr><td class='rank' id='rank_5'></td></tr>
                  <tr><td class='suit' id='suit_5'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_6' onclick='move_card(6)'>
                  <tr><td class='rank' id='rank_6'></td></tr>
                  <tr><td class='suit' id='suit_6'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_7' onclick='move_card(7)'>
                  <tr><td class='rank' id='rank_7'></td></tr>
                  <tr><td class='suit' id='suit_7'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_8' onclick='move_card(8)'>
                  <tr><td class='rank' id='rank_8'></td></tr>
                  <tr><td class='suit' id='suit_8'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_9' onclick='move_card(9)'>
                  <tr><td class='rank' id='rank_9'></td></tr>
                  <tr><td class='suit' id='suit_9'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_10' onclick='move_card(10)'>
                  <tr><td class='rank' id='rank_10'></td></tr>
                  <tr><td class='suit' id='suit_10'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_11' onclick='move_card(11)'>
                  <tr><td class='rank' id='rank_11'></td></tr>
                  <tr><td class='suit' id='suit_11'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
              <td>
                <table class='card' id='card_12' onclick='move_card(12)'>
                  <tr><td class='rank' id='rank_12'></td></tr>
                  <tr><td class='suit' id='suit_12'></td></tr>
                  <tr><td></td></tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
        <td>
          <button class='menu' id='sort' onclick='sort_hand()'></button>
        </td>
      </tr>
    </table>
    <hr/>
  </body>
</html>
